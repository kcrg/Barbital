<ContentPage x:Class="Barbital.Views.PlayerView"
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:b="clr-namespace:Prism.Behaviors;assembly=Prism.Forms"
    xmlns:cells="clr-namespace:Barbital.Controls.Cells"
    xmlns:controls="clr-namespace:Barbital.Controls"
    xmlns:conv="clr-namespace:Barbital.Converters"
    xmlns:d="http://xamarin.com/schemas/2014/forms/design"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:prism="clr-namespace:Prism.Mvvm;assembly=Prism.Forms"
    Title="{Binding PageTitle}"
    prism:ViewModelLocator.AutowireViewModel="True"
    BackgroundColor="White"
    CompressedLayout.IsHeadless="True"
    Visual="Material"
    mc:Ignorable="d">
    <ContentPage.Resources>
        <ResourceDictionary>
            <conv:NegateBoolConverter x:Key="NegateBoolConverter"/>
            <conv:CarouselPositionConverter x:Key="CarouselPositionConverter"/>
        </ResourceDictionary>
    </ContentPage.Resources>

    <ContentPage.ToolbarItems>
        <controls:BaseToolbarItem Glyph="{StaticResource MoreIcon}" Text="More"/>
    </ContentPage.ToolbarItems>

    <ContentPage.Content CompressedLayout.IsHeadless="True">
        <Grid CompressedLayout.IsHeadless="True">
            <!--  Player or Details, IDK  -->

            <!--  Bottom Schedule CarouselView  -->
            <StackLayout
                Padding="0"
                VerticalOptions="EndAndExpand"
                Spacing="0">
                <Label
                    Margin="8,0,0,0"
                    FontFamily="{StaticResource BoldFont}"
                    FontSize="22"
                    IsVisible="{Binding IsLoading, Converter={StaticResource NegateBoolConverter}}"
                    Text="Ramówka"
                    TextColor="{StaticResource ColorPrimaryDark}"/>
                <!--  TODO: position  -->
                <CarouselView x:Name="scheduleView"
                    HeightRequest="120"
                    CurrentItem="{Binding SchedulePosition}"
                    IsBounceEnabled="True"
                    IsScrollAnimated="True"
                    ItemSizingStrategy="MeasureFirstItem"
                    ItemsSource="{Binding Schedule}"
                    PeekAreaInsets="80"
                    PositionChangedCommand="{Binding SchedulePositionChanged}"
                    PositionChangedCommandParameter="">
                    <CarouselView.ItemTemplate>
                        <cells:ScheduleCell/>
                    </CarouselView.ItemTemplate>
                </CarouselView>
            </StackLayout>

            <ActivityIndicator
                VerticalOptions="CenterAndExpand"
                IsRunning="{Binding IsLoading}"
                IsVisible="{Binding IsLoading}"
                Color="{StaticResource ColorSecondary}"/>
        </Grid>
    </ContentPage.Content>
</ContentPage>